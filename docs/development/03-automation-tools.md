# Copilotä½œæ¥­è¨˜éŒ²03: è‡ªå‹•åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨é–‹ç™ºæ”¯æ´ãƒ„ãƒ¼ãƒ«

## ãƒ„ãƒ¼ãƒ«æ§‹é€ ã®å†è¨­è¨ˆï¼ˆè¿½åŠ å®Ÿè£…ï¼‰

### tools/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆ

#### è¨­è¨ˆæ€æƒ³
- **é›†ç´„åŒ–**: ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—é–¢é€£ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®é›†ä¸­ç®¡ç†
- **ã‚·ã‚§ãƒ«å¯¾å¿œ**: Bash/Zshä¸¡å¯¾å¿œã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ç’°å¢ƒã«æœ€é©åŒ–
- **ä¿å®ˆæ€§**: æ©Ÿèƒ½åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«åˆ†å‰²ã§ä¿å®ˆã—ã‚„ã™ã„æ§‹é€ 

#### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ
```
tools/
â”œâ”€â”€ README.md      # ãƒ„ãƒ¼ãƒ«ã®èª¬æ˜ã¨ã‚¬ã‚¤ãƒ‰
â”œâ”€â”€ setup.sh       # Bashç‰ˆã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â””â”€â”€ setup.zsh      # Zshç‰ˆã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
```

### ãƒ¡ã‚¤ãƒ³ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

#### setupï¼ˆã‚·ã‚§ãƒ«è‡ªå‹•é¸æŠï¼‰
```bash
#!/bin/bash
CURRENT_SHELL=$(basename "$SHELL")

case "$CURRENT_SHELL" in
    "zsh")
        exec zsh tools/setup.zsh
        ;;
    "bash")
        exec bash tools/setup.sh
        ;;
    *)
        exec bash tools/setup.sh
        ;;
esac
```

**ç‰¹å¾´**:
- ç¾åœ¨ã®ã‚·ã‚§ãƒ«ç’°å¢ƒã‚’è‡ªå‹•æ¤œå‡º
- é©åˆ‡ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è‡ªå‹•é¸æŠãƒ»å®Ÿè¡Œ
- æœªå¯¾å¿œã‚·ã‚§ãƒ«ã§ã¯bashã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯

## è‡ªå‹•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè£…

### setup.shã®ä½œæˆ

#### æ©Ÿèƒ½æ¦‚è¦
- Node.jsãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®è‡ªå‹•ç¢ºèª
- Dockerã®åˆ©ç”¨å¯å¦åˆ¤å®š
- ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—é¸æŠ
- ç’°å¢ƒã«å¿œã˜ãŸæœ€é©åŒ–ææ¡ˆ

#### ã‚¹ã‚¯ãƒªãƒ—ãƒˆæ§‹é€ 
```bash
#!/bin/bash
set -e

echo "ğŸš€ Next.jså­¦ç¿’ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚’é–‹å§‹ã—ã¾ã™..."

# Node.jsãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒã‚§ãƒƒã‚¯
if command -v node &> /dev/null; then
    NODE_VERSION=$(node --version)
    echo "ğŸ“‹ ç¾åœ¨ã®Node.jsãƒãƒ¼ã‚¸ãƒ§ãƒ³: $NODE_VERSION"

    if [[ "$NODE_VERSION" != "v22.11.0" ]]; then
        echo "âš ï¸  æ¨å¥¨Node.jsãƒãƒ¼ã‚¸ãƒ§ãƒ³: v22.11.0"

        if command -v nvm &> /dev/null; then
            echo "ğŸ”„ nvmã‚’ä½¿ç”¨ã—ã¦Node.jsãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™..."
            nvm use
        fi
    fi
fi

# ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚ªãƒ—ã‚·ãƒ§ãƒ³é¸æŠ
echo "ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ–¹æ³•ã‚’é¸æŠã—ã¦ãã ã•ã„:"
echo "1) ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒï¼ˆnpm installï¼‰"
echo "2) Dockeré–‹ç™ºç’°å¢ƒ"
echo "3) ä¸¡æ–¹ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—"
```

#### ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒ‘ã‚¿ãƒ¼ãƒ³
1. **ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒ**: npm installå®Ÿè¡Œ
2. **Dockerç’°å¢ƒ**: docker-compose buildå®Ÿè¡Œ
3. **ä¸¡æ–¹**: é †æ¬¡å®Ÿè¡Œã¨é¸æŠè‚¢æç¤º

### setup.zshï¼ˆZshç‰ˆï¼‰ã®å®Ÿè£…

#### Zshå›ºæœ‰ã®æ©Ÿèƒ½æ´»ç”¨
```zsh
#!/bin/zsh
setopt ERR_EXIT

# varedã‚³ãƒãƒ³ãƒ‰ã§ã‚ˆã‚Šè‰¯ã„å…¥åŠ›ä½“é¨“
vared -p "é¸æŠ (1-3): " -c choice

# nvmè¨­å®šã®è‡ªå‹•èª­ã¿è¾¼ã¿
if [[ -s "$HOME/.nvm/nvm.sh" ]]; then
    source "$HOME/.nvm/nvm.sh"
fi
```

#### Bashç‰ˆã¨ã®å·®ç•°
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: `setopt ERR_EXIT` vs `set -e`
- **å…¥åŠ›å‡¦ç†**: `vared`ã‚³ãƒãƒ³ãƒ‰ã§ã‚ˆã‚Šæ´—ç·´ã•ã‚ŒãŸå…¥åŠ›
- **æ¡ä»¶åˆ†å²**: `[[ ]]` ã§ã®å³å¯†ãªæ¡ä»¶è©•ä¾¡
- **nvmçµ±åˆ**: Zshç’°å¢ƒã§ã®nvmè¨­å®šè‡ªå‹•èª­ã¿è¾¼ã¿

### Makefileå®Ÿè£…

#### è¨­è¨ˆæ€æƒ³
- **ã‚·ãƒ³ãƒ—ãƒ«ãªã‚³ãƒãƒ³ãƒ‰**: è¦šãˆã‚„ã™ã„çŸ­ç¸®ã‚³ãƒãƒ³ãƒ‰
- **ãƒ˜ãƒ«ãƒ—æ©Ÿèƒ½**: `make help`ã§å…¨ã‚³ãƒãƒ³ãƒ‰è¡¨ç¤º
- **å­¦ç¿’æ”¯æ´**: å­¦ç¿’ç”¨ã®ãƒ–ãƒ©ãƒ³ãƒç®¡ç†æ©Ÿèƒ½

#### ä¸»è¦ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ
```makefile
help:           # ãƒ˜ãƒ«ãƒ—è¡¨ç¤º
setup:          # ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
install:        # ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
dev:            # ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã‚µãƒ¼ãƒãƒ¼
dev-docker:     # Dockeré–‹ç™ºã‚µãƒ¼ãƒãƒ¼
build:          # ãƒ­ãƒ¼ã‚«ãƒ«ãƒ“ãƒ«ãƒ‰
build-docker:   # Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ãƒ“ãƒ«ãƒ‰
clean:          # ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
clean-docker:   # Dockerç’°å¢ƒã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
lint:           # ESLintãƒã‚§ãƒƒã‚¯
learn-start:    # å­¦ç¿’ãƒ–ãƒ©ãƒ³ãƒä½œæˆ
learn-reset:    # mainãƒ–ãƒ©ãƒ³ãƒã¸ã®å¾©å¸°
```

#### å­¦ç¿’æ”¯æ´æ©Ÿèƒ½
```makefile
learn-start:
	@echo "ğŸ“ æ–°ã—ã„å­¦ç¿’ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ã—ã¾ã™..."
	@read -p "æ–°ã—ã„å­¦ç¿’ãƒ–ãƒ©ãƒ³ãƒåã‚’å…¥åŠ›ã—ã¦ãã ã•ã„: " branch; \
	git checkout -b learn/$$branch

learn-reset:
	@echo "ğŸ”„ å­¦ç¿’ç’°å¢ƒã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™..."
	git checkout main
	git pull origin main 2>/dev/null || echo "ãƒªãƒ¢ãƒ¼ãƒˆã‹ã‚‰ã®pullã«å¤±æ•—ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ã®ã¿ï¼‰"
```

## .gitignoreæœ€é©åŒ–

### è¿½åŠ é …ç›®ã®æ¤œè¨

#### IDEãƒ»ã‚¨ãƒ‡ã‚£ã‚¿å¯¾å¿œ
```ignore
# IDEs and editors
.vscode/        # Visual Studio Code
.idea/          # IntelliJ IDEA
*.swp           # Vim
*.swo           # Vim
*~              # Emacs
```

#### OSå›ºæœ‰ãƒ•ã‚¡ã‚¤ãƒ«
```ignore
# OS generated files
.DS_Store       # macOS
.DS_Store?      # macOS
._*             # macOS
.Spotlight-V100 # macOS
.Trashes        # macOS
ehthumbs.db     # Windows
Thumbs.db       # Windows
```

#### é–‹ç™ºé–¢é€£
```ignore
# Docker
.docker/

# Temporary files
tmp/
temp/

# Logs
logs
*.log
```

#### ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼è€ƒæ…®
```ignore
# Package manager locks (uncomment if you want to ignore them)
# package-lock.json
# yarn.lock
# pnpm-lock.yaml
```

**åˆ¤æ–­**: å­¦ç¿’ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨ã—ã¦ã¯lockãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒŸãƒƒãƒˆã—ã¦å®Œå…¨å›ºå®šåŒ–

## package.jsonã‚¹ã‚¯ãƒªãƒ—ãƒˆæ‹¡å¼µ

### è¿½åŠ ã•ã‚ŒãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆ
```json
{
  "scripts": {
    "docker:dev": "docker-compose up next-tpl-dev",
    "docker:build": "docker build -t next-tpl .",
    "docker:run": "docker run -p 3000:3000 next-tpl",
    "check-updates": "npm outdated",
    "audit-security": "npm audit",
    "update-safe": "npm update && npm audit fix"
  }
}
```

### å®Ÿè¡Œæ¨©é™è¨­å®š
```bash
chmod +x /home/tani09/allprojects/next-tpl/setup.sh
```

## é–‹ç™ºãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æœ€é©åŒ–

### æ¨å¥¨é–‹ç™ºãƒ‘ã‚¿ãƒ¼ãƒ³

#### ãƒ‘ã‚¿ãƒ¼ãƒ³1: å€‹äººå­¦ç¿’
```bash
# æ–°ã—ã„å­¦ç¿’ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé–‹å§‹
git clone https://github.com/user/next-tpl.git learn-routing
cd learn-routing
make learn-start
# ãƒ–ãƒ©ãƒ³ãƒåå…¥åŠ›: routing-practice
make dev
```

#### ãƒ‘ã‚¿ãƒ¼ãƒ³2: Dockerå­¦ç¿’
```bash
git clone https://github.com/user/next-tpl.git docker-practice
cd docker-practice
make dev-docker
```

#### ãƒ‘ã‚¿ãƒ¼ãƒ³3: å®Ÿé¨“ç’°å¢ƒ
```bash
git clone https://github.com/user/next-tpl.git experiment
cd experiment
make setup
# é¸æŠ: 3) ä¸¡æ–¹ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
```

### ç’°å¢ƒãƒªã‚»ãƒƒãƒˆæ‰‹é †
```bash
# ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã®ãƒªã‚»ãƒƒãƒˆ
make clean
make install

# Dockerç’°å¢ƒã®ãƒªã‚»ãƒƒãƒˆ
make clean-docker
make build-docker

# å­¦ç¿’ç’°å¢ƒã®ãƒªã‚»ãƒƒãƒˆ
make learn-reset
```

## ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨æ¤œè¨¼

### ãƒ„ãƒ¼ãƒ«æ§‹é€ ã«ã‚ˆã‚‹æ”¹å–„ç‚¹
- **çµ„ç¹”åŒ–**: ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®è«–ç†çš„é…ç½®
- **é¸æŠè‚¢**: ã‚·ã‚§ãƒ«ç’°å¢ƒã«å¿œã˜ãŸæœ€é©ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
- **ä¿å®ˆæ€§**: æ©Ÿèƒ½åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«åˆ†å‰²
- **æ‹¡å¼µæ€§**: æ–°ã—ã„ãƒ„ãƒ¼ãƒ«ã®è¿½åŠ ãŒå®¹æ˜“

### ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å …ç‰¢æ€§
- **Bashç‰ˆ**: `set -e`ã§ã‚¨ãƒ©ãƒ¼æ™‚ã®å³åº§çµ‚äº†
- **Zshç‰ˆ**: `setopt ERR_EXIT`ã§ã‚ˆã‚Šå³å¯†ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- ã‚³ãƒãƒ³ãƒ‰å­˜åœ¨ç¢ºèª: `command -v`
- æ¡ä»¶åˆ†å²ã§ã®é©åˆ‡ãªãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

### ã‚·ã‚§ãƒ«è‡ªå‹•é¸æŠã®ä¿¡é ¼æ€§
- `$SHELL`ç’°å¢ƒå¤‰æ•°ã«ã‚ˆã‚‹ç¾åœ¨ã‚·ã‚§ãƒ«æ¤œå‡º
- æœªå¯¾å¿œã‚·ã‚§ãƒ«ã§ã®bashãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
- execã«ã‚ˆã‚‹é©åˆ‡ãªãƒ—ãƒ­ã‚»ã‚¹ç½®æ›

### Makefileã®ä¿¡é ¼æ€§
- `.PHONY`ã‚¿ãƒ¼ã‚²ãƒƒãƒˆæ˜ç¤º
- ã‚¨ãƒ©ãƒ¼æ™‚ã®é©åˆ‡ãªçµ‚äº†ã‚³ãƒ¼ãƒ‰
- ä¾å­˜é–¢ä¿‚ã®æ˜ç¢ºåŒ–

## æˆæœã¨åŠ¹æœ

### è‡ªå‹•åŒ–é”æˆãƒ¬ãƒ™ãƒ«
- âœ… ãƒ¯ãƒ³ã‚³ãƒãƒ³ãƒ‰ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—: `./setup`ï¼ˆã‚·ã‚§ãƒ«è‡ªå‹•é¸æŠï¼‰
- âœ… ã‚·ã‚§ãƒ«å¯¾å¿œã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—: `bash tools/setup.sh` / `zsh tools/setup.zsh`
- âœ… ç°¡å˜é–‹ç™ºé–‹å§‹: `make dev`
- âœ… å­¦ç¿’ãƒ–ãƒ©ãƒ³ãƒç®¡ç†: `make learn-start`
- âœ… ç’°å¢ƒãƒªã‚»ãƒƒãƒˆ: `make clean`

### ãƒ„ãƒ¼ãƒ«æ§‹é€ ã«ã‚ˆã‚‹æ”¹å–„
1. **ã‚·ã‚§ãƒ«æœ€é©åŒ–**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ç’°å¢ƒã«æœ€é©ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œ
2. **çµ„ç¹”åŒ–**: tools/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ã®è«–ç†çš„é…ç½®
3. **ä¿å®ˆæ€§**: æ©Ÿèƒ½åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«åˆ†å‰²ã«ã‚ˆã‚‹ç®¡ç†ã—ã‚„ã™ã•
4. **æ‹¡å¼µæ€§**: æ–°æ©Ÿèƒ½è¿½åŠ ã®å®¹æ˜“ã•

### å­¦ç¿’è€…ä½“é¨“å‘ä¸Š
1. **å³åº§é–‹å§‹**: git clone â†’ setup â†’ é–‹ç™ºé–‹å§‹
2. **ç’°å¢ƒé©å¿œ**: Bash/Zshè‡ªå‹•é¸æŠã§ã‚¹ãƒˆãƒ¬ã‚¹ãƒ•ãƒªãƒ¼
3. **é¸æŠè‚¢æç¤º**: ç’°å¢ƒã«å¿œã˜ãŸæœ€é©ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
4. **å¤±æ•—å›å¾©**: ç°¡å˜ãªãƒªã‚»ãƒƒãƒˆæ‰‹é †
5. **å­¦ç¿’ç®¡ç†**: ãƒ–ãƒ©ãƒ³ãƒã§ã®å­¦ç¿’å†…å®¹æ•´ç†

---
**é–¢é€£è¨˜éŒ²**:
- [02-docker-environment.md](./02-docker-environment.md) - Dockerç’°å¢ƒæ§‹ç¯‰ã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³å›ºå®š
- [04-documentation-strategy.md](./04-documentation-strategy.md) - ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™ã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³æˆ¦ç•¥
